.\" Automatically generated by Pandoc 2.17.0.1
.\"
.TH "BARMAN-CLOUD-CHECK-WAL-ARCHIVE" "1" "January 21, 2022" "Barman User manuals" "Version 2.18"
.hy
.SH NAME
.PP
barman-cloud-check-wal-archive - Check a WAL archive destination for a
new PostgreSQL cluster
.SH SYNOPSIS
.PP
barman-cloud-check-wal-archive [\f[I]OPTIONS\f[R]] \f[I]SOURCE_URL\f[R]
\f[I]SERVER_NAME\f[R]
.SH DESCRIPTION
.PP
Check that the WAL archive destination for \f[I]SERVER_NAME\f[R] is safe
to use for a new PostgreSQL cluster.
With no optional args (the default) this check will pass if the WAL
archive is empty or if the target bucket cannot be found.
All other conditions will result in failure.
.PP
This script and Barman are administration tools for disaster recovery of
PostgreSQL servers written in Python and maintained by EnterpriseDB.
.SH POSITIONAL ARGUMENTS
.TP
SOURCE_URL
URL of the cloud source, such as a bucket in AWS S3.
For example: \f[C]s3://BUCKET_NAME/path/to/folder\f[R] (where
\f[C]BUCKET_NAME\f[R] is the bucket you have created in AWS).
.TP
SERVER_NAME
the name of the server as configured in Barman.
.SH OPTIONS
.TP
-h, \[en]help
show a help message and exit
.TP
-V, \[en]version
show program\[cq]s version number and exit
.TP
-v, \[en]verbose
increase output verbosity (e.g., -vv is more than -v)
.TP
-q, \[en]quiet
decrease output verbosity (e.g., -qq is less than -q)
.TP
-t, \[en]test
test connectivity to the cloud destination and exit
.TP
\[en]timeline
A positive integer specifying the earliest timeline for which associated
WALs should cause the check to fail.
The check will pass if all WAL content in the archive relates to earlier
timelines.
If any WAL files are on this timeline or greater then the check will
fail.
.TP
\[en]cloud-provider {aws-s3,azure-blob-storage}
the cloud provider to which the backup should be uploaded
.TP
-P, \[en]profile
profile name (e.g.\ INI section in AWS credentials file)
.TP
\[en]endpoint-url
override the default S3 URL construction mechanism by specifying an
endpoint.
.TP
\[en]credential {azure-cli,managed-identity}
optionally specify the type of credential to use when authenticating
with Azure Blob Storage.
If omitted then the credential will be obtained from the environment.
If no credentials can be found in the environment then the default Azure
authentication flow will be used.
.SH REFERENCES
.PP
For Boto:
.IP \[bu] 2
https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html
.PP
For AWS:
.IP \[bu] 2
http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-set-up.html
.IP \[bu] 2
http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html.
.PP
For Azure Blob Storage:
.IP \[bu] 2
https://docs.microsoft.com/en-us/azure/storage/blobs/authorize-data-operations-cli#set-environment-variables-for-authorization-parameters
.IP \[bu] 2
https://docs.microsoft.com/en-us/python/api/azure-storage-blob/?view=azure-python
.SH DEPENDENCIES
.PP
If using \f[C]--cloud-provider=aws-s3\f[R]:
.IP \[bu] 2
boto3
.PP
If using \f[C]--cloud-provider=azure-blob-storage\f[R]:
.IP \[bu] 2
azure-storage-blob
.IP \[bu] 2
azure-identity (optional, if you wish to use DefaultAzureCredential)
.SH EXIT STATUS
.TP
0
Success
.TP
1
Failure
.TP
2
The connection to the cloud provider failed
.TP
3
There was an error in the command input
.TP
Other non-zero codes
Error running the check
.SH BUGS
.PP
Barman has been extensively tested, and is currently being used in
several production environments.
However, we cannot exclude the presence of bugs.
.PP
Any bug can be reported via the Github issue tracker.
.SH RESOURCES
.IP \[bu] 2
Homepage: <http://www.pgbarman.org/>
.IP \[bu] 2
Documentation: <http://docs.pgbarman.org/>
.IP \[bu] 2
Professional support: <http://www.enterprisedb.com/>
.SH COPYING
.PP
Barman is the property of EnterpriseDB UK Limited and its code is
distributed under GNU General Public License v3.
.PP
\[co] Copyright EnterpriseDB UK Limited 2011-2022
.SH AUTHORS
EnterpriseDB <http://www.enterprisedb.com>.
